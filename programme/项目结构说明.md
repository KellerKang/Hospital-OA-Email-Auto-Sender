# 医院数据自动化系统 - 项目结构说明

## 项目概述
这是一个完整的医院数据自动化系统，包含数据库提取、Excel生成、邮件发送和OA系统集成功能。

## 目录结构

### 📁 核心程序文件
- `main.py` - 主程序入口，协调整个自动化流程
- `config.py` - 系统配置文件，包含数据库连接、邮件设置等
- `requirements.txt` - Python依赖包列表

### 📁 数据库相关
- `database_extractor.py` - 数据库数据提取模块
- `extract_outpatient_to_excel.py` - 门诊数据提取并保存为Excel
- `insert_outpatient_records.py` - 向数据库插入测试门诊记录
- `test_oracle_connection.py` - Oracle数据库连接测试
- `oracle_troubleshooting.py` - Oracle问题诊断和解决工具
- `tnsnames_template.ora` - Oracle TNS配置文件模板

### 📁 邮件系统
- `email_sender.py` - 邮件发送模块
- `simple_oa_mail.py` - 轻量级OA邮箱系统（Flask应用）
- `test_email_automation.py` - 邮件自动化测试脚本

### 📁 系统管理
- `schedule_task.py` - Windows计划任务管理脚本
- `test_system.py` - 系统功能测试脚本

### 📁 模板文件
- `templates/` - OA邮箱系统的HTML模板
  - `base.html` - 基础模板
  - `login.html` - 登录页面
  - `inbox.html` - 收件箱页面
  - `compose.html` - 写邮件页面
  - `sent.html` - 发件箱页面
  - `view_email.html` - 邮件查看页面

### 📁 数据文件
- `uploads/` - 上传文件目录
  - `*.xlsx` - 生成的Excel数据文件
- `oa_mail.db` - OA邮箱系统的SQLite数据库

### 📁 日志文件
- `main.log` - 主程序运行日志
- `database_extractor.log` - 数据库提取日志
- `email_sender.log` - 邮件发送日志

### 📁 文档文件
- `README.md` - 项目说明文档
- `使用说明.md` - 详细使用指南
- `可行性分析.md` - 项目可行性分析
- `流程图说明.md` - 系统流程图说明
- `Oracle安装配置指南.md` - Oracle数据库安装配置指南

## 使用流程

### 1. 环境准备
```bash
pip install -r requirements.txt
```

### 2. 数据库配置
- 确保Oracle数据库已安装并运行
- 修改 `config.py` 中的数据库连接信息
- 运行 `test_oracle_connection.py` 测试连接

### 3. 数据准备
```bash
python insert_outpatient_records.py  # 插入测试数据
python extract_outpatient_to_excel.py  # 提取数据到Excel
```

### 4. 启动OA系统
```bash
python simple_oa_mail.py
```

### 5. 测试自动化流程
```bash
python test_email_automation.py
```

### 6. 设置定时任务
```bash
python schedule_task.py
```

## 系统特点
- ✅ 完整的自动化流程
- ✅ 模块化设计，易于维护
- ✅ 详细的日志记录
- ✅ 完整的错误处理
- ✅ 用户友好的界面
- ✅ 灵活的配置管理

## 注意事项
1. 首次使用前请仔细阅读 `使用说明.md`
2. 确保Oracle数据库服务正常运行
3. 检查网络连接和防火墙设置
4. 定期备份重要数据文件 